import{_ as s,v as a,b as n,R as l}from"./chunks/framework.caa0fbaf.js";const A=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"markdown/生态/Solon Validation/article-son/captcha-solon-plugin.md","filePath":"markdown/生态/Solon Validation/article-son/captcha-solon-plugin.md"}'),p={name:"markdown/生态/Solon Validation/article-son/captcha-solon-plugin.md"},o=l(`<div class="language-xml"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">dependency</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">org.noear</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">captcha-solon-plugin</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">dependency</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><h4 id="_1、描述" tabindex="-1">1、描述 <a class="header-anchor" href="#_1、描述" aria-label="Permalink to &quot;1、描述&quot;">​</a></h4><p>基础扩展插件，基于 AJ-Captcha 适配，提供图形的验证码支持（支持 web, ios, android 等...）。AJ-Captcha 代码仓库：<a href="https://gitee.com/anji-plus/captcha" target="_blank" rel="noreferrer">https://gitee.com/anji-plus/captcha</a></p><h4 id="_2、使用示例" tabindex="-1">2、使用示例 <a class="header-anchor" href="#_2、使用示例" aria-label="Permalink to &quot;2、使用示例&quot;">​</a></h4><p><a href="https://gitee.com/noear/captcha/tree/master/service/solon" target="_blank" rel="noreferrer">https://gitee.com/noear/captcha/tree/master/service/solon</a></p><p><a href="https://gitee.com/noear/captcha/tree/master/view/html" target="_blank" rel="noreferrer">https://gitee.com/noear/captcha/tree/master/view/html</a></p><h4 id="_3、配置参考" tabindex="-1">3、配置参考 <a class="header-anchor" href="#_3、配置参考" aria-label="Permalink to &quot;3、配置参考&quot;">​</a></h4><ul><li>配置参考</li></ul><p><a href="https://ajcaptcha.beliefteam.cn/captcha-doc/" target="_blank" rel="noreferrer">https://ajcaptcha.beliefteam.cn/captcha-doc/</a></p><ul><li>配置示例</li></ul><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F07178;">aj.captcha</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;"># aes加密坐标开启或者禁用(true|false)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">aes-status</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;"># 缓存local/redis...</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">cache-type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">local</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">history-data-clear-enable</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">false</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;"># 滑动干扰项(0/1/2)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">interference-options</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;"># 滑动验证，底图路径，不配置将使用默认图片</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;"># 支持全路径</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;"># 支持项目路径,以classpath:开头,取resource目录下路径,例：classpath:images/jigsaw</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">#    jigsaw: classpath:images/jigsaw</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;"># 支持项目路径,以classpath:开头,取resource目录下路径,例：classpath:images/pic-click</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">#    pic-click: classpath:images/pic-click</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;"># check接口一分钟内请求数限制</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">req-check-minute-limit</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">60</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;"># 接口请求次数一分钟限制是否开启 true|false</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">req-frequency-limit-enable</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;"># 验证失败5次，get接口锁定</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">req-get-lock-limit</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">5</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;"># 验证失败后，锁定时间间隔,s</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">req-get-lock-seconds</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">360</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;"># get接口一分钟内请求数限制</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">req-get-minute-limit</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">30</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;"># check接口一分钟内请求数限制</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">req-verify-minute-limit</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">60</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;"># 校验滑动拼图允许误差偏移量(默认5像素)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">slip-offset</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">5</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;"># 验证码类型default两种都实例化。</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">default</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;"># 汉字统一使用Unicode,保证程序通过@value读取到是中文，可通过这个在线转换;yml格式不需要转换</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;"># https://tool.chinaz.com/tools/unicode.aspx 中文转Unicode</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">water-mark</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">com.cn</span></span></code></pre></div><p>后端较验示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Controller</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">LoginController</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Inject</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">CaptchaService</span><span style="color:#A6ACCD;"> captchaService</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Post</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Mapping</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/login</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">ResponseModel</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">CaptchaVO</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">captchaVO</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">//必传参数：captchaVO.captchaVerification</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">ResponseModel</span><span style="color:#A6ACCD;"> response </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> captchaService</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">verification</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">captchaVO</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">response</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">isSuccess</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">false)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">//验证码校验失败，返回信息告诉前端</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">//repCode  0000  无异常，代表成功</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">//repCode  9999  服务器内部异常</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">//repCode  0011  参数不能为空</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">//repCode  6110  验证码已失效，请重新获取</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">//repCode  6111  验证失败</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">//repCode  6112  获取验证码失败,请联系管理员</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">//repCode  6113  底图未初始化成功，请检查路径</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">//repCode  6201  get接口请求次数超限，请稍后再试!</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">//repCode  6206  无效请求，请重新获取验证码</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">//repCode  6202  接口验证失败数过多，请稍后再试</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">//repCode  6204  check接口请求次数超限，请稍后再试!</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> response</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h4 id="具体参考" tabindex="-1">具体参考 <a class="header-anchor" href="#具体参考" aria-label="Permalink to &quot;具体参考&quot;">​</a></h4><ul><li><a href="https://gitee.com/noear/solon-examples/tree/dev/3.Solon-Web/demo3038-auth_captcha" target="_blank" rel="noreferrer">https://gitee.com/noear/solon-examples/tree/dev/3.Solon-Web/demo3038-auth_captcha</a></li></ul>`,15),e=[o];function t(c,r,y,i,D,F){return a(),n("div",null,e)}const h=s(p,[["render",t]]);export{A as __pageData,h as default};
